<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How to change the IP of a node."><link rel="shortcut icon" href=../../../images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.4"><title>Change Node IP - ComputeStacks Documentation</title><link rel=stylesheet href=../../../assets/stylesheets/main.15aa0b43.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.75751829.min.css><meta name=theme-color content=#2094f3><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../../css/timeago.css></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#how-to-change-the-ip-of-a-node class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../../.. title="ComputeStacks Documentation" class="md-header-nav__button md-logo" aria-label="ComputeStacks Documentation"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><defs><style>.fa-secondary{opacity:.4}</style></defs><path class=fa-secondary d="M96 0H32A32 32 0 0 0 0 32v64h128V32A32 32 0 0 0 96 0zM0 384h128V128H0zm0 96a32 32 0 0 0 32 32h64a32 32 0 0 0 32-32v-64H0zm513.62-17.78L401.08 42.71l-60.26 16.14 112.35 418.8c.11.39.2.79.29 1.18l60.29-16.15c-.04-.15-.09-.3-.13-.46zM160 480a32 32 0 0 0 32 32h64a32 32 0 0 0 32-32v-64H160zM256 0h-64a32 32 0 0 0-32 32v64h124.79l-8-29.65a23.94 23.94 0 0 1 11.17-27V32A32 32 0 0 0 256 0zm-96 384h128V128H160z"/><path class=fa-primary d="M0 416h128v-32H0zm0-288h128V96H0zm575.17 317.65L460.39 17.78a23.89 23.89 0 0 0-29.18-17h-.09L415.73 5a24 24 0 0 0-16.9 29.36l114.79 427.86a23.89 23.89 0 0 0 29.18 17h.09l15.38-4.22a24 24 0 0 0 16.9-29.35zM160 416h128v-32H160zM338.39 49.78a23.89 23.89 0 0 0-29.18-17h-.09L293.73 37a24 24 0 0 0-16.9 29.36l8 29.65H160v32h128V108l103.62 386.22a23.89 23.89 0 0 0 29.18 17h.09l15.38-4.22a24 24 0 0 0 16.9-29.33z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> ComputeStacks Documentation </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Change Node IP </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../getting_started/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Admin Guide </a> </li> <li class=md-tabs__item> <a href=../../../user_guide/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../../admin_api/ class=md-tabs__link> Admin API </a> </li> <li class=md-tabs__item> <a href=../../../user_api/latest/ class=md-tabs__link> User API </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="ComputeStacks Documentation" class="md-nav__button md-logo" aria-label="ComputeStacks Documentation"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><defs><style>.fa-secondary{opacity:.4}</style></defs><path class=fa-secondary d="M96 0H32A32 32 0 0 0 0 32v64h128V32A32 32 0 0 0 96 0zM0 384h128V128H0zm0 96a32 32 0 0 0 32 32h64a32 32 0 0 0 32-32v-64H0zm513.62-17.78L401.08 42.71l-60.26 16.14 112.35 418.8c.11.39.2.79.29 1.18l60.29-16.15c-.04-.15-.09-.3-.13-.46zM160 480a32 32 0 0 0 32 32h64a32 32 0 0 0 32-32v-64H160zM256 0h-64a32 32 0 0 0-32 32v64h124.79l-8-29.65a23.94 23.94 0 0 1 11.17-27V32A32 32 0 0 0 256 0zm-96 384h128V128H160z"/><path class=fa-primary d="M0 416h128v-32H0zm0-288h128V96H0zm575.17 317.65L460.39 17.78a23.89 23.89 0 0 0-29.18-17h-.09L415.73 5a24 24 0 0 0-16.9 29.36l114.79 427.86a23.89 23.89 0 0 0 29.18 17h.09l15.38-4.22a24 24 0 0 0 16.9-29.35zM160 416h128v-32H160zM338.39 49.78a23.89 23.89 0 0 0-29.18-17h-.09L293.73 37a24 24 0 0 0-16.9 29.36l8 29.65H160v32h128V108l103.62 386.22a23.89 23.89 0 0 0 29.18 17h.09l15.38-4.22a24 24 0 0 0 16.9-29.33z"/></svg> </a> ComputeStacks Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Getting Started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../getting_started/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../getting_started/architecture_overview/ class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=../../../getting_started/notifications/ class=md-nav__link> Notifications </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-4 type=checkbox id=nav-2-4> <label class=md-nav__link for=nav-2-4> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=2> <label class=md-nav__title for=nav-2-4> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../getting_started/installation/0_requirements/ class=md-nav__link> Plan </a> </li> <li class=md-nav__item> <a href=../../../getting_started/installation/1_prepare/ class=md-nav__link> Prepare </a> </li> <li class=md-nav__item> <a href=../../../getting_started/installation/2_perform/ class=md-nav__link> Run </a> </li> <li class=md-nav__item> <a href=../../../getting_started/installation/3_finalize/ class=md-nav__link> Finalize </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-5 type=checkbox id=nav-2-5> <label class=md-nav__link for=nav-2-5> Integrations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Integrations data-md-level=2> <label class=md-nav__title for=nav-2-5> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../getting_started/integrations/webhooks/ class=md-nav__link> WebHooks </a> </li> <li class=md-nav__item> <a href=../../../getting_started/integrations/whmcs_plugin/ class=md-nav__link> WHMCS </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Admin Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Admin Guide" data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"></span> Admin Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> Billing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Billing data-md-level=2> <label class=md-nav__title for=nav-3-2> <span class="md-nav__icon md-icon"></span> Billing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../billing/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../billing/billing_plans/ class=md-nav__link> Billing Plans </a> </li> <li class=md-nav__item> <a href=../../billing/free_trial/ class=md-nav__link> Setup Free Trials </a> </li> <li class=md-nav__item> <a href=../../billing/integrations/ class=md-nav__link> Handle Invoicing & Payments </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3 checked> <label class=md-nav__link for=nav-3-3> Cluster Management <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cluster Management" data-md-level=2> <label class=md-nav__title for=nav-3-3> <span class="md-nav__icon md-icon"></span> Cluster Management </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Change Node IP <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Change Node IP </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#process-overview class=md-nav__link> Process Overview </a> </li> <li class=md-nav__item> <a href=#generate-new-certificates class=md-nav__link> Generate New Certificates </a> <nav class=md-nav aria-label="Generate New Certificates"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#unseal-vault class=md-nav__link> Unseal Vault </a> </li> <li class=md-nav__item> <a href=#etcd class=md-nav__link> etcd </a> </li> <li class=md-nav__item> <a href=#calico-network class=md-nav__link> Calico Network </a> </li> <li class=md-nav__item> <a href=#consul class=md-nav__link> Consul </a> </li> <li class=md-nav__item> <a href=#docker class=md-nav__link> docker </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#iptables class=md-nav__link> IPTables </a> </li> <li class=md-nav__item> <a href=#backups class=md-nav__link> Backups </a> </li> <li class=md-nav__item> <a href=#update-computestacks class=md-nav__link> Update ComputeStacks </a> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> Conclusion </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cs_database/ class=md-nav__link> Controller Database </a> </li> <li class=md-nav__item> <a href=../load_balancer/ class=md-nav__link> Load Balancer </a> </li> <li class=md-nav__item> <a href=../resource_management/ class=md-nav__link> Resource Management </a> </li> <li class=md-nav__item> <a href=../change_region_name/ class=md-nav__link> Rename Region </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-4 type=checkbox id=nav-3-4> <label class=md-nav__link for=nav-3-4> System Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="System Administration" data-md-level=2> <label class=md-nav__title for=nav-3-4> <span class="md-nav__icon md-icon"></span> System Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sysadmin/controller_backups/ class=md-nav__link> Controller Backup </a> </li> <li class=md-nav__item> <a href=../../sysadmin/upgrade_agent/ class=md-nav__link> Update Agent </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-5 type=checkbox id=nav-3-5> <label class=md-nav__link for=nav-3-5> Custom Integrations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Custom Integrations" data-md-level=2> <label class=md-nav__title for=nav-3-5> <span class="md-nav__icon md-icon"></span> Custom Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../custom_integration/full_api/ class=md-nav__link> API Only </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> User Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User Guide" data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_guide/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_guide/backups/ class=md-nav__link> Backups </a> </li> <li class=md-nav__item> <a href=../../../user_guide/developer-tools/ class=md-nav__link> Developer Tools </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4-4 type=checkbox id=nav-4-4> <label class=md-nav__link for=nav-4-4> Container Images <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Container Images" data-md-level=2> <label class=md-nav__title for=nav-4-4> <span class="md-nav__icon md-icon"></span> Container Images </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_guide/container_images/elastic-search/ class=md-nav__link> ElasticSearch </a> </li> <li class=md-nav__item> <a href=../../../user_guide/container_images/redis/ class=md-nav__link> Redis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4-4-3 type=checkbox id=nav-4-4-3> <label class=md-nav__link for=nav-4-4-3> Wordpress <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wordpress data-md-level=3> <label class=md-nav__title for=nav-4-4-3> <span class="md-nav__icon md-icon"></span> Wordpress </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_guide/container_images/wordpress/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_guide/container_images/wordpress_apache/ class=md-nav__link> Apache to LiteSpeed </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../user_guide/container_images/whmcs/ class=md-nav__link> WHMCS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4-5 type=checkbox id=nav-4-5> <label class=md-nav__link for=nav-4-5> Core Concepts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Concepts" data-md-level=2> <label class=md-nav__title for=nav-4-5> <span class="md-nav__icon md-icon"></span> Core Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_guide/core-concepts/mail/ class=md-nav__link> Sending Mail </a> </li> <li class=md-nav__item> <a href=../../../user_guide/core-concepts/ssh/ class=md-nav__link> SSH & File Access </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4-6 type=checkbox id=nav-4-6> <label class=md-nav__link for=nav-4-6> How To <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="How To" data-md-level=2> <label class=md-nav__title for=nav-4-6> <span class="md-nav__icon md-icon"></span> How To </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_guide/how-to/building-images/ class=md-nav__link> Building Images </a> </li> <li class=md-nav__item> <a href=../../../user_guide/how-to/clone-project/ class=md-nav__link> Cloning Projects </a> </li> <li class=md-nav__item> <a href=../../../user_guide/how-to/moving/ class=md-nav__link> Migrating Existing Application </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4-7 type=checkbox id=nav-4-7> <label class=md-nav__link for=nav-4-7> Third Party <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Third Party" data-md-level=2> <label class=md-nav__title for=nav-4-7> <span class="md-nav__icon md-icon"></span> Third Party </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_guide/third-party/cloudflare/ class=md-nav__link> Cloudflare </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Admin API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Admin API" data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"></span> Admin API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/container_services/ class=md-nav__link> Container Services </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> Billing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Billing data-md-level=2> <label class=md-nav__title for=nav-5-3> <span class="md-nav__icon md-icon"></span> Billing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/billing/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/billing/products/ class=md-nav__link> Products </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/billing/billing_plans/ class=md-nav__link> Billing Plans </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/billing/resources/ class=md-nav__link> Billing Resources </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/billing/phases/ class=md-nav__link> Billing Phases </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/billing/prices/ class=md-nav__link> Resource Prices </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-4 type=checkbox id=nav-5-4> <label class=md-nav__link for=nav-5-4> DNS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=DNS data-md-level=2> <label class=md-nav__title for=nav-5-4> <span class="md-nav__icon md-icon"></span> DNS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/zones/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/zones/collaborators/ class=md-nav__link> Collaborations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-5 type=checkbox id=nav-5-5> <label class=md-nav__link for=nav-5-5> Infrastructure <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Infrastructure data-md-level=2> <label class=md-nav__title for=nav-5-5> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/infrastructure/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/infrastructure/locations/ class=md-nav__link> Regions </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/infrastructure/regions/ class=md-nav__link> Availability Zones </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/infrastructure/nodes/ class=md-nav__link> Nodes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-6 type=checkbox id=nav-5-6> <label class=md-nav__link for=nav-5-6> Images <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Images data-md-level=2> <label class=md-nav__title for=nav-5-6> <span class="md-nav__icon md-icon"></span> Images </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/images/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/images/collaborations/ class=md-nav__link> Collaborations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-7 type=checkbox id=nav-5-7> <label class=md-nav__link for=nav-5-7> Networking <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networking data-md-level=2> <label class=md-nav__title for=nav-5-7> <span class="md-nav__icon md-icon"></span> Networking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/networking/domains/ class=md-nav__link> Domains </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/networking/ingress_rules/ class=md-nav__link> Ingress Rules </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-8 type=checkbox id=nav-5-8> <label class=md-nav__link for=nav-5-8> Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Projects data-md-level=2> <label class=md-nav__title for=nav-5-8> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/projects/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/projects/collaborators/ class=md-nav__link> Collaborations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-9 type=checkbox id=nav-5-9> <label class=md-nav__link for=nav-5-9> Registry <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Registry data-md-level=2> <label class=md-nav__title for=nav-5-9> <span class="md-nav__icon md-icon"></span> Registry </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/registry/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/registry/collaborators/ class=md-nav__link> Collaborations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-10 type=checkbox id=nav-5-10> <label class=md-nav__link for=nav-5-10> Subscription Management <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Subscription Management" data-md-level=2> <label class=md-nav__title for=nav-5-10> <span class="md-nav__icon md-icon"></span> Subscription Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/subscriptions/subscriptions/ class=md-nav__link> Subscriptions </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/subscriptions/usage/ class=md-nav__link> Usage </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5-11 type=checkbox id=nav-5-11> <label class=md-nav__link for=nav-5-11> User Management <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User Management" data-md-level=2> <label class=md-nav__title for=nav-5-11> <span class="md-nav__icon md-icon"></span> User Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../admin_api/latest/users/ class=md-nav__link> Users </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/users/user_groups/ class=md-nav__link> Groups </a> </li> <li class=md-nav__item> <a href=../../../admin_api/latest/users/ssh_keys/ class=md-nav__link> SSH Keys </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> User API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User API" data-md-level=1> <label class=md-nav__title for=nav-6> <span class="md-nav__icon md-icon"></span> User API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/collaborations/ class=md-nav__link> Collaborators </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/containers/ class=md-nav__link> Containers </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-4 type=checkbox id=nav-6-4> <label class=md-nav__link for=nav-6-4> Container Registry <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Container Registry" data-md-level=2> <label class=md-nav__title for=nav-6-4> <span class="md-nav__icon md-icon"></span> Container Registry </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/container_registry/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/container_registry/collaborations/ class=md-nav__link> Collaborators </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-5 type=checkbox id=nav-6-5> <label class=md-nav__link for=nav-6-5> Container Services <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Container Services" data-md-level=2> <label class=md-nav__title for=nav-6-5> <span class="md-nav__icon md-icon"></span> Container Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/container_services/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/container_services/metadata/ class=md-nav__link> Metadata </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/container_services/resources/ class=md-nav__link> Resources </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/container_services/ssl/ class=md-nav__link> SSL </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../user_api/latest/domains/ class=md-nav__link> Domains </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-7 type=checkbox id=nav-6-7> <label class=md-nav__link for=nav-6-7> DNS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=DNS data-md-level=2> <label class=md-nav__title for=nav-6-7> <span class="md-nav__icon md-icon"></span> DNS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/zones/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/zones/collaborations/ class=md-nav__link> Collaborators </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../user_api/latest/events/ class=md-nav__link> Events </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-9 type=checkbox id=nav-6-9> <label class=md-nav__link for=nav-6-9> Images <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Images data-md-level=2> <label class=md-nav__title for=nav-6-9> <span class="md-nav__icon md-icon"></span> Images </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/images/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/images/collaborations/ class=md-nav__link> Collaborators </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/images/providers/ class=md-nav__link> Providers </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-9-4 type=checkbox id=nav-6-9-4> <label class=md-nav__link for=nav-6-9-4> Parameters <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Parameters data-md-level=3> <label class=md-nav__title for=nav-6-9-4> <span class="md-nav__icon md-icon"></span> Parameters </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/images/params/env/ class=md-nav__link> Env </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/images/params/ingress/ class=md-nav__link> Ingress </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/images/params/relationships/ class=md-nav__link> Relationships </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/images/params/settings/ class=md-nav__link> Settings </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/images/params/volumes/ class=md-nav__link> Volumes </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../user_api/latest/load_balancers/ class=md-nav__link> Load Balancers </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/locations/ class=md-nav__link> Locations </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-12 type=checkbox id=nav-6-12> <label class=md-nav__link for=nav-6-12> Networks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networks data-md-level=2> <label class=md-nav__title for=nav-6-12> <span class="md-nav__icon md-icon"></span> Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/network/ class=md-nav__link> Ingress Rules </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../user_api/latest/orders/ class=md-nav__link> Orders </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/products/ class=md-nav__link> Products </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-15 type=checkbox id=nav-6-15> <label class=md-nav__link for=nav-6-15> Profile <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Profile data-md-level=2> <label class=md-nav__title for=nav-6-15> <span class="md-nav__icon md-icon"></span> Profile </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/user/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/user/ssh/ class=md-nav__link> SSH Keys </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-16 type=checkbox id=nav-6-16> <label class=md-nav__link for=nav-6-16> Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Projects data-md-level=2> <label class=md-nav__title for=nav-6-16> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/projects/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/projects/collaborations/ class=md-nav__link> Collaborators </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/projects/resources/ class=md-nav__link> Resources </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-17 type=checkbox id=nav-6-17> <label class=md-nav__link for=nav-6-17> Subscriptions <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Subscriptions data-md-level=2> <label class=md-nav__title for=nav-6-17> <span class="md-nav__icon md-icon"></span> Subscriptions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/subscriptions/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/subscriptions/billing_events/ class=md-nav__link> Billing Events </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/subscriptions/usage/ class=md-nav__link> Usage </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6-18 type=checkbox id=nav-6-18> <label class=md-nav__link for=nav-6-18> Volumes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Volumes data-md-level=2> <label class=md-nav__title for=nav-6-18> <span class="md-nav__icon md-icon"></span> Volumes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../user_api/latest/volumes/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../user_api/latest/volumes/backup/ class=md-nav__link> Backups </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=how-to-change-the-ip-of-a-node>How to change the IP of a node<a class=headerlink href=#how-to-change-the-ip-of-a-node title="Permanent link">&para;</a></h1> <p>Various services on the node require certificate authentication. As part of that process, we use the ip address of the server in the certificate &ndash; this must match the ip that the server will be connecting from. When changing that IP, you must generate new certificates.</p> <p>In this example, we will use the following:</p> <ul> <li>NEW IPs for our server: <code>8.8.8.8</code>, and a private ip of: <code>10.0.0.2</code></li> <li>The OLD IPs were: <code>1.1.1.1</code>, and a private IP of: <code>10.10.0.20</code></li> <li>The hostname is node101</li> </ul> <div class="admonition danger"> <p>In most configurations, consul is bound to the <em>public ip</em>, and etcd is bound to the <em>private ip</em>. Your configuration may be different, so please double check the current configuration to find the correct IP before proceeding.</p> </div> <h2 id=process-overview>Process Overview<a class=headerlink href=#process-overview title="Permanent link">&para;</a></h2> <p>The steps we will take to update the node IP Address will involve the following:</p> <ol> <li>Generating new certificates using vault</li> <li>Updating configuration files on the node for all related services</li> <li>Updating iptable rules on all servers in your environment</li> <li>Updating the configuration in ComputeStacks</li> <li>Testing configuration.</li> </ol> <p>Prior to proceeding with this, first make sure that connectivity works between all servers that will be required to communicate with each other, and that relevant SSH keys exist (this should have already been taken care of by our installer).</p> <h2 id=generate-new-certificates>Generate New Certificates<a class=headerlink href=#generate-new-certificates title="Permanent link">&para;</a></h2> <h3 id=unseal-vault>Unseal Vault<a class=headerlink href=#unseal-vault title="Permanent link">&para;</a></h3> <p>Before continuing, navigate back to your ansible project that you used to create your cluster, and run the following command to unseal vault on the controller.</p> <div class=highlight><pre><span></span><code>ansible-playbook -u root -i inventory.yml main.yml --tags &quot;vault_unseal&quot;
</code></pre></div> <div class="admonition tip"> <p>If you have multiple availability zones, and therefore multiple inventory files, just pick any of them. Vault runs on the controller, so therefore all inventory files will work.</p> </div> <h3 id=etcd>etcd<a class=headerlink href=#etcd title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>docker exec -it vault-bootstrap vault write pki/etcd/issue/server \
                                                common_name=node101 \
                                                ip_sans=&quot;127.0.0.1,8.8.8.8,10.0.0.2&quot; \
                                                ttl=43800h
</code></pre></div> <p>Replace the contents of <code>/etc/etcd/certs/server/server.key</code> and <code>/etc/etcd/certs/server/server.crt</code> respectively. </p> <p>note: you will need to <code>chmod +w</code> and <code>chmod -w</code> the file before, and after, updating ALL the files in this process.</p> <p>With the certificates updated, now change the IP Address.</p> <details class=example><summary>Multiple nodes</summary><div class=highlight><pre><span></span><code><span class=c1># on the node being changed, stop etcd</span>
systemctl stop etcd

<span class=c1># Get the member id (from another node)</span>
etcdctl member list

<span class=c1># update with (where 3f0a39ffd865c7a6 is the member id found in the previous command)</span>
etcdctl member update 3f0a39ffd865c7a6 --peer-urls<span class=o>=</span>https://10.0.0.2:2380
sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /etc/etcd/etcd.conf    
</code></pre></div> </details> <details class=example><summary>Single Node</summary><div class=highlight><pre><span></span><code>systemctl stop etcd
sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /etc/etcd/etcd.conf
</code></pre></div> </details> <p>Back on the node you&rsquo;re modifying: <div class=highlight><pre><span></span><code>sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /etc/profile.d/etcdctl.sh <span class=o>&amp;&amp;</span> <span class=nb>source</span> /etc/profile.d/etcdctl.sh
systemctl start etcd
</code></pre></div></p> <div class="admonition danger"> <p>Ensure etcd is working before proceeding by running <code>etcdctl member list</code>.</p> </div> <h3 id=calico-network>Calico Network<a class=headerlink href=#calico-network title="Permanent link">&para;</a></h3> <p>Next step is to update the etcd configuration for calico, our network management tool. Please use this snippet, just replace your IPs:</p> <div class=highlight><pre><span></span><code>sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /etc/calico/calicoctl.cfg <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /etc/calico/calico-ipam.env <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /usr/local/bin/run_calico <span class=o>&amp;&amp;</span> systemctl restart calico-ipam <span class=o>&amp;&amp;</span> docker stop calico-node <span class=o>&amp;&amp;</span> docker rm calico-node <span class=o>&amp;&amp;</span> /usr/local/bin/run_calico
</code></pre></div> <h3 id=consul>Consul<a class=headerlink href=#consul title="Permanent link">&para;</a></h3> <div class="admonition abstract"> <p class=admonition-title>consul certificates</p> <div class=highlight><pre><span></span><code>docker <span class=nb>exec</span> -it vault-bootstrap vault write pki/consul/issue/server <span class=se>\</span>
                                            <span class=nv>common_name</span><span class=o>=</span>node101 <span class=se>\</span>
                                            <span class=nv>alt_names</span><span class=o>=</span>localhost <span class=se>\</span>
                                            <span class=nv>ip_sans</span><span class=o>=</span><span class=s2>&quot;127.0.0.1,8.8.8.8,10.0.0.2&quot;</span> <span class=se>\</span>
                                            <span class=nv>ttl</span><span class=o>=</span>43800h
</code></pre></div> </div> <p>Update the certificate files under <code>/etc/consul/ssl</code> and `/etc/computestacks/certs/consul/.</p> <p>You will also need to update the systemd file to ensure administrative consul cli commands still function. Here is a complete command to perform that, and restart consul:</p> <div class=highlight><pre><span></span><code>sed -i <span class=s1>&#39;s/1.1.1.1/8.8.8.8/g&#39;</span> /etc/systemd/system/consul.service <span class=o>&amp;&amp;</span> systemctl daemon-reload <span class=o>&amp;&amp;</span> systemctl restart consul
</code></pre></div> <p>You will also need to update our agent configuration file. Here is a one-liner, just replace the IPs:</p> <div class=highlight><pre><span></span><code>chmod +w /etc/computestacks/agent.yml <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/1.1.1.1/8.8.8.8/g&#39;</span> /etc/computestacks/agent.yml <span class=o>&amp;&amp;</span> chmod -w /etc/computestacks/agent.yml <span class=o>&amp;&amp;</span> systemctl restart cs-agent
</code></pre></div> <h3 id=docker>docker<a class=headerlink href=#docker title="Permanent link">&para;</a></h3> <div class="admonition abstract"> <p class=admonition-title>docker certificates</p> <div class=highlight><pre><span></span><code>docker <span class=nb>exec</span> -it vault-bootstrap vault write pki/docker/issue/server <span class=se>\</span>
                                                <span class=nv>common_name</span><span class=o>=</span>node101 <span class=se>\</span>
                                                <span class=nv>alt_names</span><span class=o>=</span>localhost <span class=se>\</span>
                                                <span class=nv>ip_sans</span><span class=o>=</span><span class=s2>&quot;127.0.0.1,8.8.8.8,10.0.0.2&quot;</span> <span class=se>\</span>
                                                <span class=nv>ttl</span><span class=o>=</span>43800h
</code></pre></div> </div> <p>Update the certificate files under <code>/etc/docker/certs</code> and <code>/etc/computestacks/certs/docker</code>.</p> <p>Update the docker etcd configuration with this snippet:</p> <div class=highlight><pre><span></span><code>sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /etc/systemd/system/docker.service.d/startup.conf <span class=o>&amp;&amp;</span> systemctl daemon-reload <span class=o>&amp;&amp;</span> systemctl restart docker
</code></pre></div> <h2 id=iptables>IPTables<a class=headerlink href=#iptables title="Permanent link">&para;</a></h2> <p>You will now need to ensure that all the iptables are updated. You may find our persistence file here: <code>/usr/local/bin/cs-recover_iptables</code>. Please update all relevant IP Addresses. <em>This needs to be done on ALL your servers</em>.</p> <p>Once you&rsquo;ve done that, <em>manually</em> run the individual lines <em>(don&rsquo;t re-run the entire file!)</em>.</p> <p>For example, run this on each server to delete the old rule and add the new rule:</p> <div class=highlight><pre><span></span><code>iptables -D INPUT -p all -s 1.1.1.1 -j ACCEPT
iptables -A INPUT -p all -s 8.8.8.8 -j ACCEPT
</code></pre></div> <h2 id=backups>Backups<a class=headerlink href=#backups title="Permanent link">&para;</a></h2> <p>In addition to the iptable rules, you will also need to update the nfs exports list on the backup server. Here is a one-line example:</p> <div class=highlight><pre><span></span><code>sed -i <span class=s1>&#39;s/10.10.0.20/10.0.0.2/g&#39;</span> /etc/exports <span class=o>&amp;&amp;</span> exportfs -ra
</code></pre></div> <p>This will modfy the exports file on the backup server, and reload the nfs server.</p> <h2 id=update-computestacks>Update ComputeStacks<a class=headerlink href=#update-computestacks title="Permanent link">&para;</a></h2> <p>In the ComputeStacks administrator, perform the following steps:</p> <ol> <li> <p>Change the Node IP: <code>Admin -&gt; Regions -&gt; (Manage) -&gt; Edit the node</code>.</p> </li> <li> <p>Change the LoadBalancer IPs: <code>Admin -&gt; Load Balancers -&gt; Edit</code>.</p> </li> </ol> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">&para;</a></h2> <p>Once that has all been completed, you may edit the node in the ComputeStacks admin and run <code>cstacks test</code> on the controller to ensure connectivity.</p> <p>Please perform a sample deployment to ensure everything functions correctly.</p> <hr> <div class=md-source-date> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2022-05-02T19:12:06+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-05-02</span> </small> </div> </article> </div> </div> </main> <!-- Override https://github.com/squidfunk/mkdocs-material/blob/master/material/partials/footer.html --> <script>
    window.Papercups = {
        config: {
            accountId: "21bacdbb-362f-4eb0-86f3-b0d76fc60308",
            title: "Welcome to ComputeStacks",
            subtitle: "Ask us anything in the chat window below ðŸ˜Š",
            primaryColor: "#198fce",
            greeting: "",
            awayMessage: "",
            newMessagePlaceholder: "Start typing...",
            showAgentAvailability: false,
            agentAvailableText: "We're online right now!",
            agentUnavailableText: "We're away at the moment.",
            requireEmailUpfront: true,
            iconVariant: "outlined",
            baseUrl: "https://chat-widget.computestacks.com",
        },
    };
</script> <script type=text/javascript async defer src=https://chat-widget.computestacks.com/widget.js></script> </div> <script src=../../../assets/javascripts/vendor.93c04032.min.js></script> <script src=../../../assets/javascripts/bundle.83e5331e.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.instant', 'navigation.sections', 'navigation.tabs', 'toc.integrate'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src=../../../js/timeago.min.js></script> <script src=../../../js/timeago_mkdocs_material.js></script> </body> </html>